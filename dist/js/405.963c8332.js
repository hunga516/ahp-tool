"use strict";(self["webpackChunk"]=self["webpackChunk"]||[]).push([[405],{61:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ge});var r=i(252);const o={class:"container-tabview"};function s(e,t,i,s,a,n){const l=(0,r.up)("vueEtapaInputs");return(0,r.wg)(),(0,r.iD)("section",o,[(0,r.Wm)(l)])}var a=i(577),n=i(963);const l={class:"section-inputs"},c={class:"flex justify-end mb-4"},h={key:0,class:"p-4 mb-8 border-solid border-gray-300 border-[0.5px] rounded-lg"},p={class:"flex items-center justify-between mb-4"},u={key:0,class:"flex items-center justify-center h-[200px]"},d={key:1,class:"flex items-center justify-center h-[200px]"},m={class:"text-red-500"},g={key:2,class:"history-list max-h-[300px] overflow-y-auto"},b=["onClick"],P={class:"flex justify-between items-center"},y={class:"font-medium"},f={class:"text-sm text-gray-500"},v=["onClick"],_={class:"grid grid-cols-2 gap-4 mb-4"},w={class:"grid grid-rows-2 gap-4"},x={class:"p-4 border-solid border-gray-300 border-[0.5px] rounded-lg"},L={class:"mt-4 flex flex-col gap-2"},S={class:"flex items-center justify-between gap-8"},k={class:"flex items-center justify-between gap-8"},C={class:"flex items-center justify-between gap-8"},O={class:"p-4 border-solid border-gray-300 border-[0.5px] rounded-lg"},D={class:"flex items-center justify-between mb-4"},$={key:0,class:"flex items-center justify-center h-[300px]"},j={key:1,class:"flex items-center justify-center h-[300px]"},B={class:"text-red-500"},T={key:2,class:"chart-container",style:{height:"300px"}},V={class:"flex flex-col gap-4 max-h-[880px] overflow-y-scroll relative"},H=["onClick"],E=["src"],F={class:"col-span-4 flex flex-col gap-2 font-medium"},U={class:"text-sm"},z={class:"justify-self-end text-xs text-muted-foreground"},A={class:"input-container"},N={class:"criteria-section"},I={class:"input-list"},q=["onUpdate:modelValue","onBlur"],M=["onUpdate:modelValue","onBlur"],K={class:"button-group"},Z=["onClick"],J={class:"options-section"},Y={class:"input-list"},G=["onUpdate:modelValue","onBlur"],W=["onUpdate:modelValue","onBlur"],R={class:"button-group"},Q=["onClick"];function X(e,t,i,o,s,X){const ee=(0,r.up)("BarChart"),te=(0,r.up)("vueButtonProjectControl");return(0,r.wg)(),(0,r.iD)("section",l,[(0,r._)("div",c,[(0,r._)("button",{class:"flex items-center gap-2 px-3 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors",onClick:t[0]||(t[0]=(...e)=>X.toggleHistory&&X.toggleHistory(...e))},t[11]||(t[11]=[(0,r._)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[(0,r._)("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1),(0,r._)("span",null,"Lịch sử tính toán",-1)]))]),s.showHistory?((0,r.wg)(),(0,r.iD)("div",h,[(0,r._)("div",p,[t[12]||(t[12]=(0,r._)("p",{class:"font-semibold"}," Lịch sử tính toán ",-1)),(0,r._)("button",{class:"px-2 py-1 bg-black text-white font-semibold rounded-lg",onClick:t[1]||(t[1]=(...e)=>X.fetchHistory&&X.fetchHistory(...e))}," Tải lại ")]),s.historyLoading?((0,r.wg)(),(0,r.iD)("div",u,t[13]||(t[13]=[(0,r._)("p",null,"Đang tải dữ liệu...",-1)]))):s.historyError?((0,r.wg)(),(0,r.iD)("div",d,[(0,r._)("p",m,(0,a.zw)(s.historyError),1)])):((0,r.wg)(),(0,r.iD)("div",g,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.historyProjects,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e._id,class:"p-3 mb-2 border-[0.5px] border-solid border-gray-300 rounded-lg cursor-pointer hover:bg-gray-100",onClick:t=>X.loadProjectFromHistory(e)},[(0,r._)("div",P,[(0,r._)("div",null,[(0,r._)("p",y,(0,a.zw)(e.criteriosLabelPrimeira.join(", ")),1),(0,r._)("p",f,(0,a.zw)(new Date(e.timestamp).toLocaleString()),1)]),(0,r._)("button",{class:"px-2 py-1 bg-blue-500 text-white rounded-lg text-sm",onClick:(0,n.iM)((t=>X.loadProjectFromHistory(e)),["stop"])}," Nhập dữ liệu ",8,v)])],8,b)))),128))]))])):(0,r.kq)("",!0),(0,r._)("div",_,[(0,r._)("div",w,[(0,r._)("div",x,[t[17]||(t[17]=(0,r._)("p",{class:"font-semibold"}," Bộ lọc ",-1)),t[18]||(t[18]=(0,r._)("p",{class:"text-muted-foreground text-xs"}," Lọc theo các nhu cầu chọn quá của bạn ",-1)),(0,r._)("div",L,[(0,r._)("div",S,[t[14]||(t[14]=(0,r._)("p",{class:"font-semibold text-sm w-24"}," Giá thuê ",-1)),(0,r.wy)((0,r._)("input",{name:"price",class:"px-2 py-1 w-full placeholder:text-sm border-[0.5px] rounded-lg",placeholder:"Nhập giá thuê","onUpdate:modelValue":t[2]||(t[2]=e=>s.filterParams.price=e)},null,512),[[n.nr,s.filterParams.price]])]),(0,r._)("div",k,[t[15]||(t[15]=(0,r._)("p",{class:"font-semibold text-sm w-24"}," Diện tích ",-1)),(0,r.wy)((0,r._)("input",{name:"area",class:"px-2 py-1 w-full placeholder:text-sm border-[0.5px] rounded-lg",placeholder:"Nhập diện tích","onUpdate:modelValue":t[3]||(t[3]=e=>s.filterParams.area=e)},null,512),[[n.nr,s.filterParams.area]])]),(0,r._)("div",C,[t[16]||(t[16]=(0,r._)("p",{class:"font-semibold text-sm w-24"}," Mức thu nhập trung bình ",-1)),(0,r.wy)((0,r._)("input",{name:"income",class:"px-2 py-1 w-full placeholder:text-sm border-[0.5px] rounded-lg",placeholder:"Nhập mức thu nhập trung bình","onUpdate:modelValue":t[4]||(t[4]=e=>s.filterParams.income=e)},null,512),[[n.nr,s.filterParams.income]])]),(0,r._)("button",{class:"px-2 py-1 mt-4 bg-black text-white font-semibold rounded-lg",onClick:t[5]||(t[5]=(...e)=>X.handleFilter&&X.handleFilter(...e))}," Lọc khu vực ")])]),(0,r._)("div",O,[(0,r._)("div",D,[t[20]||(t[20]=(0,r._)("p",{class:"font-semibold"}," Biểu đồ khu vực ",-1)),(0,r.wy)((0,r._)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>s.selectedChartType=e),class:"px-2 py-1 border-[0.5px] rounded-lg"},t[19]||(t[19]=[(0,r.uE)('<option value="price" data-v-6f7139f6>Giá thuê</option><option value="area" data-v-6f7139f6>Diện tích</option><option value="income" data-v-6f7139f6>Thu nhập</option><option value="density" data-v-6f7139f6>Mật độ dân cư</option><option value="customers" data-v-6f7139f6>Lượng khách/ngày</option><option value="cafes" data-v-6f7139f6>Số lượng quán cafe</option>',6)]),512),[[n.bM,s.selectedChartType]])]),s.loading?((0,r.wg)(),(0,r.iD)("div",$,t[21]||(t[21]=[(0,r._)("p",null,"Đang tải dữ liệu...",-1)]))):s.error?((0,r.wg)(),(0,r.iD)("div",j,[(0,r._)("p",B,(0,a.zw)(s.error),1)])):((0,r.wg)(),(0,r.iD)("div",T,[(0,r.Wm)(ee,{labels:s.chartData.labels,values:s.chartData.values,title:s.chartData.title,yAxisLabel:s.chartData.yAxisLabel},null,8,["labels","values","title","yAxisLabel"])]))])]),(0,r._)("div",V,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.locationData,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e._id,class:(0,a.C_)(["relative p-4 grid grid-cols-5 border-[0.5px] border-solid border-gray-300 rounded-lg cursor-pointer",s.selectedLocations.includes(e._id)?"bg-gray-200 border-black":""]),onClick:t=>X.toggleSelectLocation(e._id)},[(0,r._)("img",{class:"col-span-1 rounded-full w-16 h-16",src:"https://api-ahp.onrender.com/images/"+e.imageURL,alt:"Ảnh khu vực"},null,8,E),(0,r._)("div",F,[(0,r._)("p",null,(0,a.zw)(e.khu_vuc),1),(0,r._)("p",U,(0,a.zw)(e.quan),1),(0,r._)("p",z,(0,a.zw)(e.dien_tich_tb)+"m2 "+(0,a.zw)((e.chi_phi_thue/1e6).toLocaleString())+"tr/th "+(0,a.zw)((e.chi_phi_thue/e.dien_tich_tb/1e6).toLocaleString(void 0,{maximumFractionDigits:2}))+"tr/m2 ",1)])],10,H)))),128)),s.selectedLocations.length>0?((0,r.wg)(),(0,r.iD)("button",{key:0,class:"sticky bottom-0 left-0 right-0 z-10 px-4 py-2 bg-green-600 text-white rounded shadow-lg mt-2",onClick:t[7]||(t[7]=(...e)=>X.applySelectedLocations&&X.applySelectedLocations(...e))}," Áp dụng các khu vực đã chọn ")):(0,r.kq)("",!0)])]),(0,r._)("div",A,[(0,r._)("div",N,[t[24]||(t[24]=(0,r._)("h2",{class:"section-title"},"Tiêu chí đánh giá",-1)),t[25]||(t[25]=(0,r._)("div",{class:"header-labels"},[(0,r._)("label",{class:"label-short"},"Viết tắt"),(0,r._)("label",{class:"label-long"},"Tên tiêu chí")],-1)),(0,r._)("div",I,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.criteriosLabelPrimeira,((e,i)=>((0,r.wg)(),(0,r.iD)("div",{key:i,class:"input-row"},[(0,r.wy)((0,r._)("input",{class:"input-short","onUpdate:modelValue":e=>s.criteriosSimboloPrimeira[i]=e,maxlength:"5",onBlur:e=>X.checkBlankText("criteriosSimboloPrimeira",i,"C")},null,40,q),[[n.nr,s.criteriosSimboloPrimeira[i]]]),(0,r.wy)((0,r._)("input",{class:"input-long","onUpdate:modelValue":e=>s.criteriosLabelPrimeira[i]=e,maxlength:"20",onBlur:e=>X.checkBlankText("criteriosLabelPrimeira",i,"Criterion-")},null,40,M),[[n.nr,s.criteriosLabelPrimeira[i]]]),(0,r._)("div",K,[(0,r._)("button",{onClick:e=>X.removeCriterio(i),class:"action-button remove-btn",tabindex:"-1"},t[22]||(t[22]=[(0,r._)("span",null,"-",-1)]),8,Z),i===s.criteriosLabelPrimeira.length-1?((0,r.wg)(),(0,r.iD)("button",{key:0,onClick:t[8]||(t[8]=e=>X.addCriterio()),class:"action-button add-btn",tabindex:"-1"},t[23]||(t[23]=[(0,r._)("span",null,"+",-1)]))):(0,r.kq)("",!0)])])))),128))])]),(0,r._)("div",J,[t[28]||(t[28]=(0,r._)("h2",{class:"section-title"},"Phương án lựa chọn",-1)),t[29]||(t[29]=(0,r._)("div",{class:"header-labels"},[(0,r._)("label",{class:"label-short"},"Viết tắt"),(0,r._)("label",{class:"label-long"},"Tên phương án")],-1)),(0,r._)("div",Y,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.optionsLabelPrimeira,((e,i)=>((0,r.wg)(),(0,r.iD)("div",{key:i,class:"input-row"},[(0,r.wy)((0,r._)("input",{class:"input-short","onUpdate:modelValue":e=>s.optionsSimboloPrimeira[i]=e,maxlength:"5",onBlur:e=>X.checkBlankText("optionsSimboloPrimeira",i,"O")},null,40,G),[[n.nr,s.optionsSimboloPrimeira[i]]]),(0,r.wy)((0,r._)("input",{class:"input-long","onUpdate:modelValue":e=>s.optionsLabelPrimeira[i]=e,maxlength:"20",onBlur:e=>X.checkBlankText("optionsLabelPrimeira",i,"Option-")},null,40,W),[[n.nr,s.optionsLabelPrimeira[i]]]),(0,r._)("div",R,[(0,r._)("button",{onClick:e=>X.removeOption(i),class:"action-button remove-btn",tabindex:"-1"},t[26]||(t[26]=[(0,r._)("span",null,"-",-1)]),8,Q),i===s.optionsLabelPrimeira.length-1?((0,r.wg)(),(0,r.iD)("button",{key:0,onClick:t[9]||(t[9]=e=>X.addOption()),class:"action-button add-btn",tabindex:"-1"},t[27]||(t[27]=[(0,r._)("span",null,"+",-1)]))):(0,r.kq)("",!0)])])))),128))])])]),(0,r.Wm)(te,{onUpdateView:t[10]||(t[10]=e=>X.importHandler())})])}var ee=i(581);const te={computed:{criteriosPrimeira(){return this.$store.getters.currentCriteriosLabelPrimeira},optionsPrimeira(){return this.$store.getters.currentOptionsLabelPrimeira},criteriosSegunda(){return this.$store.getters.currentCriteriosLabelSegunda},optionsSegunda(){return this.$store.getters.currentOptionsLabelSegunda},currentImportFlag(){return this.$store.getters.currentImportFlag},currentViewProgress(){return this.$store.getters.currentViewProgress}},methods:{arranjoCriterios(){const e=[];for(let t=0;t<this.criteriosSegunda.length;t++)for(let i=0;i<this.criteriosSegunda.length;i++)t<i&&e.push({id:`${t+1}${i+1}`,texto:`${this.criteriosSegunda[t]} vs ${this.criteriosSegunda[i]}`,valor:50});return e},arranjoOptions(){const e=[];for(let t=0;t<this.optionsPrimeira.length;t++)for(let i=0;i<this.optionsPrimeira.length;i++)t<i&&e.push({id:`${t+1}${i+1}`,texto:`${this.optionsPrimeira[t]} vs ${this.optionsPrimeira[i]}`,valor:50});return e},criaSlideresPrimeira(){const e=[];for(let t=0;t<this.criteriosPrimeira.length;t++)e.push(this.arranjoOptions());return e},criaSlideresSegunda(){const e=this.arranjoCriterios();return e},mergeSlideresMatrix(e,t){const i=JSON.parse(JSON.stringify(t));for(let r=0;r<t.length;r++)for(let o=0;o<t[r].length;o++)e[r]&&e[r][o]&&(i[r][o].texto=e[r][o].texto,i[r][o].valor=e[r][o].valor);return i},mergeSlideresVetor(e,t){const i=JSON.parse(JSON.stringify(t));for(let r=0;r<t.length;r++)e[r]&&e[r]&&(i[r].texto=e[r].texto,i[r].valor=e[r].valor);return i},criaSlideres(){const e=this.criaSlideresPrimeira(),t=this.criaSlideresSegunda();if(this.currentImportFlag||1!=this.currentViewProgress||(console.log(!this.currentImportFlag,1==this.currentViewProgress),console.log("Criando Slideres"),this.$store.dispatch("changeSlideresPrimeira",e),this.$store.dispatch("changeSlideresSegunda",t)),this.currentImportFlag||this.currentViewProgress>1){console.log("Mesclando novos Slideres");const i=this.$store.getters.currentSlideresPrimeira,r=this.$store.getters.currentSlideresSegunda,o=this.mergeSlideresMatrix(i,e),s=this.mergeSlideresVetor(r,t);this.$store.dispatch("changeSlideresPrimeira",o),this.$store.dispatch("changeSlideresSegunda",s)}}}},ie=te,re=ie;var oe=i(547),se=i(972);const ae=async()=>{try{const e=await fetch("https://api-ahp.onrender.com/data");if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();return t}catch(e){throw console.error("Error fetching location data:",e),e}},ne=(e,t)=>{const i={labels:[],values:[],title:"",yAxisLabel:""};switch(t){case"price":i.labels=e.map((e=>e.khu_vuc)),i.values=e.map((e=>e.chi_phi_thue/1e6)),i.title="Biểu đồ giá thuê theo khu vực",i.yAxisLabel="Giá thuê (triệu đồng)";break;case"area":i.labels=e.map((e=>e.khu_vuc)),i.values=e.map((e=>e.dien_tich_tb)),i.title="Biểu đồ diện tích trung bình theo khu vực",i.yAxisLabel="Diện tích (m²)";break;case"income":i.labels=e.map((e=>e.khu_vuc)),i.values=e.map((e=>e.muc_thu_nhap_tb/1e6)),i.title="Biểu đồ thu nhập trung bình theo khu vực",i.yAxisLabel="Thu nhập (triệu đồng)";break;case"density":i.labels=e.map((e=>e.khu_vuc)),i.values=e.map((e=>e.mat_do_dan_cu)),i.title="Biểu đồ mật độ dân cư theo khu vực",i.yAxisLabel="Mật độ (người/km²)";break;case"customers":i.labels=e.map((e=>e.khu_vuc)),i.values=e.map((e=>e.luong_khach_tb_ngay)),i.title="Biểu đồ lượng khách trung bình/ngày theo khu vực",i.yAxisLabel="Số lượng khách/ngày";break;case"cafes":i.labels=e.map((e=>e.khu_vuc)),i.values=e.map((e=>e.so_luong_quan_cafe)),i.title="Biểu đồ số lượng quán cafe theo khu vực",i.yAxisLabel="Số lượng quán";break}return i},le=async e=>{try{const t=new URLSearchParams;e.price&&t.append("chi_phi_thue",e.price),e.area&&t.append("dien_tich_tb",e.area),e.income&&t.append("muc_thu_nhap_tb",e.income);const i=await fetch(`https://api-ahp.onrender.com/data?${t}`);if(!i.ok)throw new Error("Network response was not ok");const r=await i.json();return r}catch(t){throw console.error("Error fetching filtered data:",t),t}},ce={name:"vue-inputs-etapa",components:{vueButtonProjectControl:ee.Z,BarChart:se.Z},mixins:[re,oe.Z],data(){return{optionsLabelPrimeira:["Phương án 1","Phương án 2","Phương án 3","Phương án 4"],optionsSimboloPrimeira:["O1","O2","O3","O4"],criteriosLabelPrimeira:["Tiêu chí 1","Tiêu chí 2","Tiêu chí 3","Tiêu chí 4"],criteriosSimboloPrimeira:["TC1","TC2","TC3","TC4"],locationData:[],chartData:{labels:[],values:[],title:"",yAxisLabel:""},selectedChartType:"price",loading:!0,error:null,filterParams:{price:"",area:"",income:""},selectedLocations:[],historyProjects:[],historyLoading:!1,historyError:null,showHistory:!1}},computed:{currentOptionsLabelPrimeira(){return this.$store.getters.currentOptionsLabelPrimeira},currentOptionsSimboloPrimeira(){return this.$store.getters.currentOptionsSimboloPrimeira},currentCriteriosLabelPrimeira(){return this.$store.getters.currentCriteriosLabelPrimeira},currentCriteriosSimboloPrimeira(){return this.$store.getters.currentCriteriosSimboloPrimeira},selectedLocationObjects(){return this.locationData.filter((e=>this.selectedLocations.includes(e._id)))}},updated(){this.saveProject()},mounted(){this.updateFromStore(),this.criaSlideres(),this.fetchData(),this.fetchHistory()},beforeUnmount(){this.updateFromStore(),this.criaSlideres()},methods:{importHandler(){this.$store.dispatch("changeImportFlag",!0),this.updateFromStore()},updateFromStore(){this.currentOptionsLabelPrimeira.length>0&&(this.optionsLabelPrimeira=this.currentOptionsLabelPrimeira),this.currentCriteriosLabelPrimeira.length>0&&(this.criteriosLabelPrimeira=this.currentCriteriosLabelPrimeira),this.currentOptionsSimboloPrimeira.length>0&&(this.optionsSimboloPrimeira=this.currentOptionsSimboloPrimeira),this.currentCriteriosSimboloPrimeira.length>0&&(this.criteriosSimboloPrimeira=this.currentCriteriosSimboloPrimeira);try{this.$store.dispatch("changeCriteriosLabelPrimeira",this.criteriosLabelPrimeira),this.$store.dispatch("changeCriteriosLabelSegunda",this.criteriosLabelPrimeira),this.$store.dispatch("changeOptionsLabelPrimeira",this.optionsLabelPrimeira),this.$store.dispatch("changeOptionsLabelSegunda",this.optionsLabelPrimeira),this.$store.dispatch("changeCriteriosSimboloPrimeira",this.criteriosSimboloPrimeira),this.$store.dispatch("changeCriteriosSimboloSegunda",this.criteriosSimboloPrimeira),this.$store.dispatch("changeOptionsSimboloPrimeira",this.optionsSimboloPrimeira),this.$store.dispatch("changeOptionsSimboloSegunda",this.optionsSimboloPrimeira)}catch(e){console.log("falha no armazenamento",e)}},checkBlankText(e,t,i){""===this[e][t].trim()&&(this[e][t]=i+(t+1))},addCriterio(){this.criteriosLabelPrimeira.length<9?(this.criteriosLabelPrimeira.push(`Criterion-${this.criteriosLabelPrimeira.length+1}`),this.criteriosSimboloPrimeira.push(`C${this.criteriosSimboloPrimeira.length+1}`)):window.alert("Bạn đã đạt đến giới hạn số lượng tiêu chí cho phép!")},removeCriterio(e){this.criteriosLabelPrimeira.length>3?(this.criteriosLabelPrimeira.splice(e,1),this.criteriosSimboloPrimeira.splice(e,1)):window.alert("Bạn phải có ít nhất 3 tiêu chí để phân tích!")},addOption(){this.optionsLabelPrimeira.length<5?(this.optionsLabelPrimeira.push(`Option-${this.optionsLabelPrimeira.length+1}`),this.optionsSimboloPrimeira.push(`O${this.optionsSimboloPrimeira.length+1}`)):window.alert("Bạn đã đạt đến giới hạn số lượng phương án cho phép!")},removeOption(e){this.optionsLabelPrimeira.length>3?(this.optionsLabelPrimeira.splice(e,1),this.optionsSimboloPrimeira.splice(e,1)):window.alert("Bạn phải có ít nhất 3 phương án để phân tích!")},async fetchData(){try{this.loading=!0,this.error=null,this.locationData=await ae(),this.updateChartData(this.selectedChartType)}catch(e){this.error="Không thể tải dữ liệu",console.error("Error:",e)}finally{this.loading=!1}},updateChartData(e){let t=this.locationData;this.selectedLocations.length>0&&(t=this.locationData.filter((e=>this.selectedLocations.includes(e._id)))),this.chartData=ne(t,e)},async handleFilter(){try{this.loading=!0,this.error=null;const e={price:Number(this.filterParams.price)||void 0,area:Number(this.filterParams.area)||void 0,income:Number(this.filterParams.income)||void 0};this.locationData=await le(e),this.selectedLocations=[],this.updateChartData(this.selectedChartType)}catch(e){this.error="Không thể lọc dữ liệu",console.error("Error:",e)}finally{this.loading=!1}},toggleSelectLocation(e){const t=this.selectedLocations.indexOf(e);-1===t?this.selectedLocations.push(e):this.selectedLocations.splice(t,1),this.updateChartData(this.selectedChartType)},async fetchHistory(){try{this.historyLoading=!0,this.historyError=null;const e=await fetch("https://api-ahp.onrender.com/api/projects");if(!e.ok)throw new Error("Không thể tải lịch sử");const t=await e.json();this.historyProjects=t.projects}catch(e){this.historyError=e.message,console.error("Error fetching history:",e)}finally{this.historyLoading=!1}},async loadProjectFromHistory(e){try{this.$store.dispatch("changeImportFlag",!0),Object.keys(e).forEach((t=>{"_id"!==t&&"timestamp"!==t&&this.$store.dispatch(`change${t.charAt(0).toUpperCase()+t.slice(1)}`,e[t])})),this.optionsLabelPrimeira=e.optionsLabelPrimeira,this.optionsSimboloPrimeira=e.optionsSimboloPrimeira,this.criteriosLabelPrimeira=e.criteriosLabelPrimeira,this.criteriosSimboloPrimeira=e.criteriosSimboloPrimeira,this.$emit("update-view"),alert("Dữ liệu đã được nhập thành công!")}catch(t){console.error("Error loading project:",t),alert("Có lỗi xảy ra khi nhập dữ liệu: "+t.message)}},toggleHistory(){this.showHistory=!this.showHistory,this.showHistory&&this.fetchHistory()},applySelectedLocations(){const e=this.selectedLocationObjects.map((e=>e.khu_vuc));this.optionsLabelPrimeira=[...e,...Array(4-e.length).fill("").map(((t,i)=>`Phương án ${e.length+i+1}`))].slice(0,4),this.optionsSimboloPrimeira=this.optionsLabelPrimeira.map(((e,t)=>`O${t+1}`))}},watch:{selectedChartType(e){this.updateChartData(e)},selectedLocations(e){e.length>0?(this.optionsLabelPrimeira=[...this.selectedLocationObjects.map((e=>e.khu_vuc))],this.optionsSimboloPrimeira=this.selectedLocationObjects.map(((e,t)=>`O${t+1}`))):(this.optionsLabelPrimeira=["Phương án 1","Phương án 2","Phương án 3","Phương án 4"],this.optionsSimboloPrimeira=["O1","O2","O3","O4"])},locationData(){0===this.selectedLocations.length&&(this.optionsLabelPrimeira=["Phương án 1","Phương án 2","Phương án 3","Phương án 4"],this.optionsSimboloPrimeira=["O1","O2","O3","O4"])}}};var he=i(744);const pe=(0,he.Z)(ce,[["render",X],["__scopeId","data-v-6f7139f6"]]),ue=pe,de={name:"vue-view-inputs-etapa",components:{vueEtapaInputs:ue}},me=(0,he.Z)(de,[["render",s],["__scopeId","data-v-52050fd0"]]),ge=me}}]);
//# sourceMappingURL=405.963c8332.js.map